<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    /* Collapsible description */
    .desc-box {
      display: none;
      background: #f8f9fa;
      padding: 10px;
      border-radius: 6px;
      margin-top: 5px;
      font-size: 14px;
      color: #333;
      box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
    }
    .view-btn {
      background: #007bff;
      color: #fff;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: 0.3s ease;
    }
    .view-btn:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <!-- Loader Screen -->
  <div id="loader">
    <div class="spinner"></div>
    <h2>Loading...</h2>
  </div>

  <!-- Your site content -->
  <div id="content" style="display:none;">
    <div class="bg">
      <div class="card fade-in">
        <h2>ðŸ“Š Complaints Dashboard</h2>
        <table class="complaints-table">
          <tr>
            <th>ID</th>
            <th>Student</th>
            <th>Category</th>
            <th>Title</th>
            <th>Description</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
          {% for c in complaints %}
          <tr class="row-animate">
            <td>{{ c[0] }}</td>
            <td>{{ c[1] }}</td>
            <td>{{ c[2] }}</td>
            <td>{{ c[3] }}</td>
            <td>
              <!-- Collapsible description -->
              <button class="view-btn" onclick="toggleDesc('desc{{ c[0] }}')">View</button>
              <div id="desc{{ c[0] }}" class="desc-box">
                {{ c[4] }}
              </div>
            </td>
            <td><span class="status {{ c[5]|lower }}">{{ c[5] }}</span></td>
            <td>
              <form action="/update_status/{{ c[0] }}" method="POST">
                <select name="status">
                  <option value="Pending">Pending</option>
                  <option value="In Progress">In Progress</option>
                  <option value="Resolved">Resolved</option>
                </select>
                <button type="submit">Update</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </table>
        <a class="logout-btn" href="/logout">ðŸšª Logout</a>
      </div>
    </div>
  </div>

  <script>
    // âœ… Show/hide description
    function toggleDesc(id) {
      let descBox = document.getElementById(id);
      if (descBox.style.display === "none" || descBox.style.display === "") {
        descBox.style.display = "block";
      } else {
        descBox.style.display = "none";
      }
    }
  </script>
  <script src="/static/script.js"></script>
</body>
</html>
